Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 60
Rules claiming more threads will be scaled down.
Job stats:
job                                count    min threads    max threads
-------------------------------  -------  -------------  -------------
all                                    1              1              1
blastn_bam_sort                        4              4              4
blastn_to_bam                          4              2              2
call_mutation_of_spike                 4              4              4
combine_runs                          16              4              4
combined_unmap                         4             12             12
compress_star_unmap                   16             12             12
count_cutadapt_reads                   2              1              1
count_genome_multiple                  1             32             32
count_site_by_sample                  16              8              8
cutadapt                               2             20             20
dedup_bam_index                        8              4              4
drop_duplicates                       16              8              8
falco_after                            4              1              1
falco_unmap                           16              1              1
filter_sites                           2              1              1
get_covered_positions_by_group         4              1              1
join_sites_by_group                    2              1              1
map_to_contamination_by_bowtie2        6             24             24
map_to_genome_by_star                  8             24             24
map_to_sncRNA_by_bowtie2               8             24             24
map_to_spike_by_bowtie2                8             24             24
map_to_spikin_by_blastn                4             24             24
merge_map                              4             12             12
merge_mutated_treated_bam              2             16             16
merge_unmap                            8             12             12
prefilter_positions_by_group           4             24             24
report_cutadapt                        1              1              1
report_falco_after                     1              1              1
report_falco_unmap                     1              1              1
report_rnaseqc                         1              1              1
report_star                            1              1              1
rnaseq_qc                              4              1              1
separate_genome_combined               4              4              4
separate_genome_dedup                  4              4              4
sort_and_filter_bam_bowtie2           23              8              8
spike_fasta                            4              1              1
stat_dedup                             4              2              2
stat_mapping                           4              2              2
total                                226              1             32

Select jobs to execute...

[Sat Oct  1 02:00:23 2022]
rule map_to_spike_by_bowtie2:
    input: bowtie2_mapping/HeLa-WT-treated-rep1-run1_contamination.1.fq, bowtie2_mapping/HeLa-WT-treated-rep1-run1_contamination.2.fq
    output: bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.sam, bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.1.fq, bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.2.fq, bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.report
    jobid: 63
    reason: Missing output files: bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.sam, bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.1.fq, bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.2.fq
    wildcards: rn=HeLa-WT-treated-rep1-run1
    threads: 24
    resources: tmpdir=/tmp, mem=96G


[Sat Oct  1 02:00:23 2022]
rule sort_and_filter_bam_bowtie2:
    input: bowtie2_mapping/HeLa-WT-treated-rep1-run1_contamination.sam
    output: run_mapping/HeLa-WT-treated-rep1-run1_contamination.bam
    jobid: 151
    reason: Missing output files: run_mapping/HeLa-WT-treated-rep1-run1_contamination.bam
    wildcards: rn=HeLa-WT-treated-rep1-run1, reftype=contamination
    threads: 8
    resources: tmpdir=/tmp, mem=32G


[Sat Oct  1 02:00:23 2022]
rule map_to_spike_by_bowtie2:
    input: bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.1.fq, bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.2.fq
    output: bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.sam, bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.1.fq, bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.2.fq, bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.report
    jobid: 51
    reason: Missing output files: bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.sam
    wildcards: rn=HeLa-WT-input-rep1-run2
    threads: 24
    resources: tmpdir=/tmp, mem=96G

[Sat Oct  1 02:00:23 2022]
[Sat Oct  1 02:00:23 2022]
Error in rule map_to_spike_by_bowtie2:
    jobid: 63
    output: bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.sam, bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.1.fq, bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.2.fq, bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.report
    shell:
        
        export LC_ALL="C"
        /opt/miniconda/bin/bowtie2 -p 24 --nofw --no-unal --end-to-end -L 16 -N 1 --mp 5 --un-conc bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.fq -x /home/yec/projects/m6A_SACseq/m6A-SACseq/test/ref/spike_expand -1 bowtie2_mapping/HeLa-WT-treated-rep1-run1_contamination.1.fq -2 bowtie2_mapping/HeLa-WT-treated-rep1-run1_contamination.2.fq > bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.sam 2> >(tee bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.report >&2)
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Error in rule sort_and_filter_bam_bowtie2:
    jobid: 151
    output: run_mapping/HeLa-WT-treated-rep1-run1_contamination.bam
    shell:
        
        /opt/miniconda/bin/samtools sort -@ 8 --input-fmt-option 'filter=[NM]<=10' -m 2G -O BAM -o run_mapping/HeLa-WT-treated-rep1-run1_contamination.bam bowtie2_mapping/HeLa-WT-treated-rep1-run1_contamination.sam
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

[Sat Oct  1 02:00:23 2022]
Removing output files of failed job map_to_spike_by_bowtie2 since they might be corrupted:
bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.sam, bowtie2_mapping/HeLa-WT-treated-rep1-run1_spike.report
Error in rule map_to_spike_by_bowtie2:
    jobid: 51
    output: bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.sam, bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.1.fq, bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.2.fq, bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.report
    shell:
        
        export LC_ALL="C"
        /opt/miniconda/bin/bowtie2 -p 24 --nofw --no-unal --end-to-end -L 16 -N 1 --mp 5 --un-conc bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.fq -x /home/yec/projects/m6A_SACseq/m6A-SACseq/test/ref/spike_expand -1 bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.1.fq -2 bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.2.fq > bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.sam 2> >(tee bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.report >&2)
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Removing output files of failed job map_to_spike_by_bowtie2 since they might be corrupted:
bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.sam, bowtie2_mapping/HeLa-WT-input-rep1-run2_spike.report
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: ../.snakemake/log/2022-10-01T020023.381365.snakemake.log
