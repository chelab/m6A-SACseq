Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 64
Rules claiming more threads will be scaled down.
Job stats:
job                             count    min threads    max threads
----------------------------  -------  -------------  -------------
all                                 1              1              1
count_site_by_sample               16              8              8
filter_sites                        2              1              1
join_sites_by_group                 2              1              1
merge_mutated_treated_bam           2             16             16
prefilter_positions_by_group        4             24             24
total                              27              1             24

Select jobs to execute...

[Sat Oct  1 03:07:54 2022]
rule merge_mutated_treated_bam:
    input: drop_duplicates/HeLa-WT-treated-rep1_sncRNA.bam, drop_duplicates/HeLa-WT-treated-rep2_sncRNA.bam
    output: merged_mutated_reads_by_group/HeLa-WT_sncRNA.bam, merged_mutated_reads_by_group/HeLa-WT_sncRNA.bam.bai
    jobid: 237
    wildcards: group=HeLa-WT, reftype=sncRNA
    threads: 16
    resources: tmpdir=/tmp, mem=64G


[Sat Oct  1 03:07:54 2022]
rule merge_mutated_treated_bam:
    input: drop_duplicates/HeLa-WT-treated-rep1_genome.bam, drop_duplicates/HeLa-WT-treated-rep2_genome.bam
    output: merged_mutated_reads_by_group/HeLa-WT_genome.bam, merged_mutated_reads_by_group/HeLa-WT_genome.bam.bai
    jobid: 254
    wildcards: group=HeLa-WT, reftype=genome
    threads: 16
    resources: tmpdir=/tmp, mem=64G

Removing temporary output file merged_mutated_reads_by_group/HeLa-WT_sncRNA.bam.bai.
[Sat Oct  1 03:07:55 2022]
Finished job 237.
1 of 27 steps (4%) done
Select jobs to execute...

[Sat Oct  1 03:07:55 2022]
rule prefilter_positions_by_group:
    input: merged_mutated_reads_by_group/HeLa-WT_sncRNA.bam
    output: filter_positions_by_group/HeLa-WT_sncRNA_T.bed
    jobid: 245
    wildcards: group=HeLa-WT, reftype=sncRNA, refbase=T
    threads: 24
    resources: tmpdir=/tmp, mem=86G


[Sat Oct  1 03:07:55 2022]
rule prefilter_positions_by_group:
    input: merged_mutated_reads_by_group/HeLa-WT_sncRNA.bam
    output: filter_positions_by_group/HeLa-WT_sncRNA_A.bed
    jobid: 236
    wildcards: group=HeLa-WT, reftype=sncRNA, refbase=A
    threads: 24
    resources: tmpdir=/tmp, mem=86G

Removing temporary output file merged_mutated_reads_by_group/HeLa-WT_genome.bam.bai.
[Sat Oct  1 03:07:55 2022]
Finished job 254.
2 of 27 steps (7%) done
Select jobs to execute...
[Sat Oct  1 03:07:56 2022]
Finished job 236.
3 of 27 steps (11%) done

[Sat Oct  1 03:07:56 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-input-rep2_sncRNA.bam, drop_duplicates/HeLa-WT-input-rep2_sncRNA.bam.bai, filter_positions_by_group/HeLa-WT_sncRNA_A.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep2_sncRNA_A.tsv
    jobid: 238
    wildcards: group=HeLa-WT, sample=HeLa-WT-input-rep2, reftype=sncRNA, refbase=A
    threads: 8
    resources: tmpdir=/tmp, mem=32G


[Sat Oct  1 03:07:56 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-input-rep1_sncRNA.bam, drop_duplicates/HeLa-WT-input-rep1_sncRNA.bam.bai, filter_positions_by_group/HeLa-WT_sncRNA_A.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep1_sncRNA_A.tsv
    jobid: 234
    wildcards: group=HeLa-WT, sample=HeLa-WT-input-rep1, reftype=sncRNA, refbase=A
    threads: 8
    resources: tmpdir=/tmp, mem=32G


[Sat Oct  1 03:07:56 2022]
rule prefilter_positions_by_group:
    input: merged_mutated_reads_by_group/HeLa-WT_genome.bam
    output: filter_positions_by_group/HeLa-WT_genome_T.bed
    jobid: 262
    wildcards: group=HeLa-WT, reftype=genome, refbase=T
    threads: 24
    resources: tmpdir=/tmp, mem=86G

Removing temporary output file merged_mutated_reads_by_group/HeLa-WT_sncRNA.bam.
[Sat Oct  1 03:07:56 2022]
Finished job 245.
4 of 27 steps (15%) done
Select jobs to execute...

[Sat Oct  1 03:07:56 2022]
rule prefilter_positions_by_group:
    input: merged_mutated_reads_by_group/HeLa-WT_genome.bam
    output: filter_positions_by_group/HeLa-WT_genome_A.bed
    jobid: 253
    wildcards: group=HeLa-WT, reftype=genome, refbase=A
    threads: 24
    resources: tmpdir=/tmp, mem=86G

[Sat Oct  1 03:07:56 2022]
Finished job 238.
5 of 27 steps (19%) done
Select jobs to execute...

[Sat Oct  1 03:07:56 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-input-rep1_sncRNA.bam, drop_duplicates/HeLa-WT-input-rep1_sncRNA.bam.bai, filter_positions_by_group/HeLa-WT_sncRNA_T.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep1_sncRNA_T.tsv
    jobid: 244
    wildcards: group=HeLa-WT, sample=HeLa-WT-input-rep1, reftype=sncRNA, refbase=T
    threads: 8
    resources: tmpdir=/tmp, mem=32G

[Sat Oct  1 03:07:56 2022]
Finished job 253.
6 of 27 steps (22%) done
[Sat Oct  1 03:07:56 2022]
Finished job 234.
7 of 27 steps (26%) done
Select jobs to execute...

[Sat Oct  1 03:07:56 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-input-rep1_genome.bam, drop_duplicates/HeLa-WT-input-rep1_genome.bam.bai, filter_positions_by_group/HeLa-WT_genome_A.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep1_genome_A.tsv
    jobid: 251
    wildcards: group=HeLa-WT, sample=HeLa-WT-input-rep1, reftype=genome, refbase=A
    threads: 8
    resources: tmpdir=/tmp, mem=32G


[Sat Oct  1 03:07:56 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-input-rep2_genome.bam, drop_duplicates/HeLa-WT-input-rep2_genome.bam.bai, filter_positions_by_group/HeLa-WT_genome_A.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep2_genome_A.tsv
    jobid: 255
    wildcards: group=HeLa-WT, sample=HeLa-WT-input-rep2, reftype=genome, refbase=A
    threads: 8
    resources: tmpdir=/tmp, mem=32G


[Sat Oct  1 03:07:56 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-treated-rep1_genome.bam, drop_duplicates/HeLa-WT-treated-rep1_genome.bam.bai, filter_positions_by_group/HeLa-WT_genome_A.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep1_genome_A.tsv
    jobid: 257
    wildcards: group=HeLa-WT, sample=HeLa-WT-treated-rep1, reftype=genome, refbase=A
    threads: 8
    resources: tmpdir=/tmp, mem=32G


[Sat Oct  1 03:07:56 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-treated-rep2_genome.bam, drop_duplicates/HeLa-WT-treated-rep2_genome.bam.bai, filter_positions_by_group/HeLa-WT_genome_A.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep2_genome_A.tsv
    jobid: 259
    wildcards: group=HeLa-WT, sample=HeLa-WT-treated-rep2, reftype=genome, refbase=A
    threads: 8
    resources: tmpdir=/tmp, mem=32G

Removing temporary output file merged_mutated_reads_by_group/HeLa-WT_genome.bam.
[Sat Oct  1 03:07:56 2022]
Finished job 262.
8 of 27 steps (30%) done
Select jobs to execute...

[Sat Oct  1 03:07:56 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-input-rep1_genome.bam, drop_duplicates/HeLa-WT-input-rep1_genome.bam.bai, filter_positions_by_group/HeLa-WT_genome_T.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep1_genome_T.tsv
    jobid: 261
    wildcards: group=HeLa-WT, sample=HeLa-WT-input-rep1, reftype=genome, refbase=T
    threads: 8
    resources: tmpdir=/tmp, mem=32G


[Sat Oct  1 03:07:56 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-input-rep2_genome.bam, drop_duplicates/HeLa-WT-input-rep2_genome.bam.bai, filter_positions_by_group/HeLa-WT_genome_T.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep2_genome_T.tsv
    jobid: 263
    wildcards: group=HeLa-WT, sample=HeLa-WT-input-rep2, reftype=genome, refbase=T
    threads: 8
    resources: tmpdir=/tmp, mem=32G


[Sat Oct  1 03:07:56 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-treated-rep1_genome.bam, drop_duplicates/HeLa-WT-treated-rep1_genome.bam.bai, filter_positions_by_group/HeLa-WT_genome_T.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep1_genome_T.tsv
    jobid: 264
    wildcards: group=HeLa-WT, sample=HeLa-WT-treated-rep1, reftype=genome, refbase=T
    threads: 8
    resources: tmpdir=/tmp, mem=32G

Select jobs to execute...
[Sat Oct  1 03:07:57 2022]
Finished job 251.
9 of 27 steps (33%) done

[Sat Oct  1 03:07:57 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-treated-rep2_genome.bam, drop_duplicates/HeLa-WT-treated-rep2_genome.bam.bai, filter_positions_by_group/HeLa-WT_genome_T.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep2_genome_T.tsv
    jobid: 265
    wildcards: group=HeLa-WT, sample=HeLa-WT-treated-rep2, reftype=genome, refbase=T
    threads: 8
    resources: tmpdir=/tmp, mem=32G

[Sat Oct  1 03:07:57 2022]
Finished job 255.
10 of 27 steps (37%) done
Select jobs to execute...

[Sat Oct  1 03:07:57 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-input-rep2_sncRNA.bam, drop_duplicates/HeLa-WT-input-rep2_sncRNA.bam.bai, filter_positions_by_group/HeLa-WT_sncRNA_T.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep2_sncRNA_T.tsv
    jobid: 246
    wildcards: group=HeLa-WT, sample=HeLa-WT-input-rep2, reftype=sncRNA, refbase=T
    threads: 8
    resources: tmpdir=/tmp, mem=32G

[Sat Oct  1 03:07:57 2022]
Finished job 244.
11 of 27 steps (41%) done
Select jobs to execute...

[Sat Oct  1 03:07:57 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-treated-rep1_sncRNA.bam, drop_duplicates/HeLa-WT-treated-rep1_sncRNA.bam.bai, filter_positions_by_group/HeLa-WT_sncRNA_T.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep1_sncRNA_T.tsv
    jobid: 247
    wildcards: group=HeLa-WT, sample=HeLa-WT-treated-rep1, reftype=sncRNA, refbase=T
    threads: 8
    resources: tmpdir=/tmp, mem=32G

[Sat Oct  1 03:07:57 2022]
Finished job 259.
12 of 27 steps (44%) done
Select jobs to execute...

[Sat Oct  1 03:07:57 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-treated-rep1_sncRNA.bam, drop_duplicates/HeLa-WT-treated-rep1_sncRNA.bam.bai, filter_positions_by_group/HeLa-WT_sncRNA_A.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep1_sncRNA_A.tsv
    jobid: 240
    wildcards: group=HeLa-WT, sample=HeLa-WT-treated-rep1, reftype=sncRNA, refbase=A
    threads: 8
    resources: tmpdir=/tmp, mem=32G

[Sat Oct  1 03:07:57 2022]
Finished job 257.
13 of 27 steps (48%) done
Select jobs to execute...

[Sat Oct  1 03:07:57 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-treated-rep2_sncRNA.bam, drop_duplicates/HeLa-WT-treated-rep2_sncRNA.bam.bai, filter_positions_by_group/HeLa-WT_sncRNA_T.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep2_sncRNA_T.tsv
    jobid: 248
    wildcards: group=HeLa-WT, sample=HeLa-WT-treated-rep2, reftype=sncRNA, refbase=T
    threads: 8
    resources: tmpdir=/tmp, mem=32G

[Sat Oct  1 03:07:57 2022]
Finished job 263.
14 of 27 steps (52%) done
[Sat Oct  1 03:07:57 2022]
Finished job 261.
15 of 27 steps (56%) done
[Sat Oct  1 03:07:57 2022]
Finished job 264.
16 of 27 steps (59%) done
Select jobs to execute...

[Sat Oct  1 03:07:57 2022]
rule count_site_by_sample:
    input: drop_duplicates/HeLa-WT-treated-rep2_sncRNA.bam, drop_duplicates/HeLa-WT-treated-rep2_sncRNA.bam.bai, filter_positions_by_group/HeLa-WT_sncRNA_A.bed
    output: pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep2_sncRNA_A.tsv
    jobid: 242
    wildcards: group=HeLa-WT, sample=HeLa-WT-treated-rep2, reftype=sncRNA, refbase=A
    threads: 8
    resources: tmpdir=/tmp, mem=32G

[Sat Oct  1 03:07:57 2022]
Finished job 265.
17 of 27 steps (63%) done
Select jobs to execute...

[Sat Oct  1 03:07:57 2022]
rule join_sites_by_group:
    input: pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep1_genome_A.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep2_genome_A.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep1_genome_A.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep2_genome_A.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep1_genome_T.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep2_genome_T.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep1_genome_T.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep2_genome_T.tsv
    output: pileup_calculate_by_group/HeLa-WT_genome.tsv.gz
    jobid: 250
    wildcards: group=HeLa-WT, reftype=genome
    resources: tmpdir=/tmp, mem=12G

[Sat Oct  1 03:07:57 2022]
Finished job 246.
18 of 27 steps (67%) done
[Sat Oct  1 03:07:57 2022]
Finished job 247.
19 of 27 steps (70%) done
[Sat Oct  1 03:07:57 2022]
Finished job 240.
20 of 27 steps (74%) done
[Sat Oct  1 03:07:57 2022]
Finished job 248.
21 of 27 steps (78%) done
[Sat Oct  1 03:07:57 2022]
Finished job 242.
22 of 27 steps (81%) done
Select jobs to execute...

[Sat Oct  1 03:07:57 2022]
rule join_sites_by_group:
    input: pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep1_sncRNA_A.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep2_sncRNA_A.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep1_sncRNA_A.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep2_sncRNA_A.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep1_sncRNA_T.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep2_sncRNA_T.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep1_sncRNA_T.tsv, pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep2_sncRNA_T.tsv
    output: pileup_calculate_by_group/HeLa-WT_sncRNA.tsv.gz
    jobid: 233
    wildcards: group=HeLa-WT, reftype=sncRNA
    resources: tmpdir=/tmp, mem=12G

[Sat Oct  1 03:07:59 2022]
Error in rule join_sites_by_group:
    jobid: 250
    output: pileup_calculate_by_group/HeLa-WT_genome.tsv.gz
    shell:
        
        /opt/pipeline/bin/join_samples_sites.py -f pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep1_genome_A.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep2_genome_A.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep1_genome_A.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep2_genome_A.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep1_genome_T.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep2_genome_T.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep1_genome_T.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep2_genome_T.tsv -n HeLa-WT-input-rep1 HeLa-WT-input-rep2 HeLa-WT-treated-rep1 HeLa-WT-treated-rep2 HeLa-WT-input-rep1 HeLa-WT-input-rep2 HeLa-WT-treated-rep1 HeLa-WT-treated-rep2 -o pileup_calculate_by_group/HeLa-WT_genome.tsv.gz
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

[Sat Oct  1 03:07:59 2022]
Error in rule join_sites_by_group:
    jobid: 233
    output: pileup_calculate_by_group/HeLa-WT_sncRNA.tsv.gz
    shell:
        
        /opt/pipeline/bin/join_samples_sites.py -f pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep1_sncRNA_A.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep2_sncRNA_A.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep1_sncRNA_A.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep2_sncRNA_A.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep1_sncRNA_T.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-input-rep2_sncRNA_T.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep1_sncRNA_T.tsv pileup_bases_by_sample/HeLa-WT_HeLa-WT-treated-rep2_sncRNA_T.tsv -n HeLa-WT-input-rep1 HeLa-WT-input-rep2 HeLa-WT-treated-rep1 HeLa-WT-treated-rep2 HeLa-WT-input-rep1 HeLa-WT-input-rep2 HeLa-WT-treated-rep1 HeLa-WT-treated-rep2 -o pileup_calculate_by_group/HeLa-WT_sncRNA.tsv.gz
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /home/yec/projects/m6A_SACseq/m6A-SACseq/test/.snakemake/log/2022-10-01T030754.389964.snakemake.log
