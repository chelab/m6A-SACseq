Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 60
Rules claiming more threads will be scaled down.
Job stats:
job                                count    min threads    max threads
-------------------------------  -------  -------------  -------------
all                                    1              1              1
blastn_bam_sort                        4              4              4
blastn_to_bam                          4              2              2
call_mutation_of_spike                 4              4              4
combine_runs                          16              4              4
combined_unmap                         4             12             12
compress_star_unmap                   16             12             12
count_cutadapt_reads                   4              1              1
count_genome_multiple                  1             32             32
count_site_by_sample                  16              8              8
cutadapt                               2             20             20
dedup_bam_index                        8              4              4
drop_duplicates                       16              8              8
falco_after                           16              1              1
falco_before                          16              1              1
falco_unmap                           16              1              1
filter_sites                           2              1              1
get_covered_positions_by_group         4              1              1
join_sites_by_group                    2              1              1
map_to_contamination_by_bowtie2        8             24             24
map_to_genome_by_star                  8             24             24
map_to_sncRNA_by_bowtie2               8             24             24
map_to_spike_by_bowtie2                8             24             24
map_to_spikin_by_blastn                4             24             24
merge_map                              4             12             12
merge_mutated_treated_bam              2             16             16
merge_unmap                            8             12             12
prefilter_positions_by_group           4             24             24
report_cutadapt                        1              1              1
report_falco_after                     1              1              1
report_falco_before                    1              1              1
report_falco_unmap                     1              1              1
report_rnaseqc                         1              1              1
report_star                            1              1              1
rnaseq_qc                              4              1              1
separate_genome_combined               4              4              4
separate_genome_dedup                  4              4              4
sort_and_filter_bam_bowtie2           24              8              8
spike_fasta                            4              1              1
stat_dedup                             4              2              2
stat_mapping                           4              2              2
total                                260              1             32

Select jobs to execute...

[Sat Oct  1 01:42:36 2022]
rule falco_before:
    input: /home/yec/projects/m6A_SACseq/m6A-SACseq/test/rawdata/HeLa-WT-polyA-treated-rep1-run1_R1.fq.gz
    output: quality_control/falco_before/HeLa-WT-treated-rep1-run1_R1/fastqc_report.html, quality_control/falco_before/HeLa-WT-treated-rep1-run1_R1/fastqc_data.txt, quality_control/falco_before/HeLa-WT-treated-rep1-run1_R1/summary.txt
    jobid: 10
    reason: Missing output files: quality_control/falco_before/HeLa-WT-treated-rep1-run1_R1/fastqc_data.txt
    wildcards: rn=HeLa-WT-treated-rep1-run1, rd=R1
    resources: tmpdir=/tmp


[Sat Oct  1 01:42:36 2022]
rule falco_before:
    input: /home/yec/projects/m6A_SACseq/m6A-SACseq/test/rawdata/HeLa-WT-polyA-treated-rep1-run2_R1.fq.gz
    output: quality_control/falco_before/HeLa-WT-treated-rep1-run2_R1/fastqc_report.html, quality_control/falco_before/HeLa-WT-treated-rep1-run2_R1/fastqc_data.txt, quality_control/falco_before/HeLa-WT-treated-rep1-run2_R1/summary.txt
    jobid: 12
    reason: Missing output files: quality_control/falco_before/HeLa-WT-treated-rep1-run2_R1/fastqc_data.txt
    wildcards: rn=HeLa-WT-treated-rep1-run2, rd=R1
    resources: tmpdir=/tmp


[Sat Oct  1 01:42:36 2022]
rule falco_before:
    input: /home/yec/projects/m6A_SACseq/m6A-SACseq/test/rawdata/HeLa-WT-polyA-treated-rep2-run1_R1.fq.gz
    output: quality_control/falco_before/HeLa-WT-treated-rep2-run1_R1/fastqc_report.html, quality_control/falco_before/HeLa-WT-treated-rep2-run1_R1/fastqc_data.txt, quality_control/falco_before/HeLa-WT-treated-rep2-run1_R1/summary.txt
    jobid: 14
    reason: Missing output files: quality_control/falco_before/HeLa-WT-treated-rep2-run1_R1/fastqc_data.txt
    wildcards: rn=HeLa-WT-treated-rep2-run1, rd=R1
    resources: tmpdir=/tmp


[Sat Oct  1 01:42:36 2022]
rule falco_after:
    input: cut_adapter/HeLa-WT-input-rep1-run2_cut_R2.fq.gz
    output: quality_control/falco_after/HeLa-WT-input-rep1-run2_R2/fastqc_report.html, quality_control/falco_after/HeLa-WT-input-rep1-run2_R2/fastqc_data.txt, quality_control/falco_after/HeLa-WT-input-rep1-run2_R2/summary.txt
    jobid: 31
    reason: Missing output files: quality_control/falco_after/HeLa-WT-input-rep1-run2_R2/fastqc_data.txt
    wildcards: rn=HeLa-WT-input-rep1-run2, rd=R2
    resources: tmpdir=/tmp


[Sat Oct  1 01:42:36 2022]
rule falco_before:
    input: /home/yec/projects/m6A_SACseq/m6A-SACseq/test/rawdata/HeLa-WT-polyA-input-rep1-run1_R1.fq.gz
    output: quality_control/falco_before/HeLa-WT-input-rep1-run1_R1/fastqc_report.html, quality_control/falco_before/HeLa-WT-input-rep1-run1_R1/fastqc_data.txt, quality_control/falco_before/HeLa-WT-input-rep1-run1_R1/summary.txt
    jobid: 2
    reason: Missing output files: quality_control/falco_before/HeLa-WT-input-rep1-run1_R1/fastqc_data.txt
    wildcards: rn=HeLa-WT-input-rep1-run1, rd=R1
    resources: tmpdir=/tmp


[Sat Oct  1 01:42:36 2022]
rule map_to_contamination_by_bowtie2:
    input: cut_adapter/HeLa-WT-input-rep1-run1_cut_R1.fq.gz, cut_adapter/HeLa-WT-input-rep1-run1_cut_R2.fq.gz
    output: bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.sam, bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.1.fq, bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.2.fq, bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.report
    jobid: 48
    reason: Missing output files: bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.1.fq, bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.2.fq, bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.sam
    wildcards: rn=HeLa-WT-input-rep1-run1
    threads: 24
    resources: tmpdir=/tmp, mem=96G


[Sat Oct  1 01:42:36 2022]
rule falco_before:
    input: /home/yec/projects/m6A_SACseq/m6A-SACseq/test/rawdata/HeLa-WT-polyA-input-rep1-run2_R2.fq.gz
    output: quality_control/falco_before/HeLa-WT-input-rep1-run2_R2/fastqc_report.html, quality_control/falco_before/HeLa-WT-input-rep1-run2_R2/fastqc_data.txt, quality_control/falco_before/HeLa-WT-input-rep1-run2_R2/summary.txt
    jobid: 5
    reason: Missing output files: quality_control/falco_before/HeLa-WT-input-rep1-run2_R2/fastqc_data.txt
    wildcards: rn=HeLa-WT-input-rep1-run2, rd=R2
    resources: tmpdir=/tmp


[Sat Oct  1 01:42:36 2022]
rule map_to_contamination_by_bowtie2:
    input: cut_adapter/HeLa-WT-input-rep1-run2_cut_R1.fq.gz, cut_adapter/HeLa-WT-input-rep1-run2_cut_R2.fq.gz
    output: bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.sam, bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.1.fq, bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.2.fq, bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.report
    jobid: 52
    reason: Missing output files: bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.1.fq, bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.sam, bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.2.fq
    wildcards: rn=HeLa-WT-input-rep1-run2
    threads: 24
    resources: tmpdir=/tmp, mem=96G


[Sat Oct  1 01:42:36 2022]
rule falco_before:
    input: /home/yec/projects/m6A_SACseq/m6A-SACseq/test/rawdata/HeLa-WT-polyA-input-rep1-run2_R1.fq.gz
    output: quality_control/falco_before/HeLa-WT-input-rep1-run2_R1/fastqc_report.html, quality_control/falco_before/HeLa-WT-input-rep1-run2_R1/fastqc_data.txt, quality_control/falco_before/HeLa-WT-input-rep1-run2_R1/summary.txt
    jobid: 4
    reason: Missing output files: quality_control/falco_before/HeLa-WT-input-rep1-run2_R1/fastqc_data.txt
    wildcards: rn=HeLa-WT-input-rep1-run2, rd=R1
    resources: tmpdir=/tmp


[Sat Oct  1 01:42:36 2022]
rule falco_before:
    input: /home/yec/projects/m6A_SACseq/m6A-SACseq/test/rawdata/HeLa-WT-polyA-input-rep2-run2_R2.fq.gz
    output: quality_control/falco_before/HeLa-WT-input-rep2-run2_R2/fastqc_report.html, quality_control/falco_before/HeLa-WT-input-rep2-run2_R2/fastqc_data.txt, quality_control/falco_before/HeLa-WT-input-rep2-run2_R2/summary.txt
    jobid: 9
    reason: Missing output files: quality_control/falco_before/HeLa-WT-input-rep2-run2_R2/fastqc_data.txt
    wildcards: rn=HeLa-WT-input-rep2-run2, rd=R2
    resources: tmpdir=/tmp


[Sat Oct  1 01:42:36 2022]
rule falco_after:
    input: cut_adapter/HeLa-WT-input-rep1-run1_cut_R1.fq.gz
    output: quality_control/falco_after/HeLa-WT-input-rep1-run1_R1/fastqc_report.html, quality_control/falco_after/HeLa-WT-input-rep1-run1_R1/fastqc_data.txt, quality_control/falco_after/HeLa-WT-input-rep1-run1_R1/summary.txt
    jobid: 28
    reason: Missing output files: quality_control/falco_after/HeLa-WT-input-rep1-run1_R1/fastqc_data.txt
    wildcards: rn=HeLa-WT-input-rep1-run1, rd=R1
    resources: tmpdir=/tmp

[Sat Oct  1 01:42:36 2022]
Error in rule map_to_contamination_by_bowtie2:
    jobid: 48
    output: bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.sam, bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.1.fq, bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.2.fq, bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.report
    shell:
        
        export LC_ALL="C"
        /opt/miniconda/bin/bowtie2 -p 24 --no-unal --end-to-end --fast --un-conc bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.fq -x /home/yec/projects/m6A_SACseq/m6A-SACseq/test/ref/contamination -1 cut_adapter/HeLa-WT-input-rep1-run1_cut_R1.fq.gz -2 cut_adapter/HeLa-WT-input-rep1-run1_cut_R2.fq.gz > bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.sam 2> >(tee bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.report >&2)
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)


[Sat Oct  1 01:42:36 2022]
rule falco_after:
    input: cut_adapter/HeLa-WT-input-rep1-run2_cut_R1.fq.gz
    output: quality_control/falco_after/HeLa-WT-input-rep1-run2_R1/fastqc_report.html, quality_control/falco_after/HeLa-WT-input-rep1-run2_R1/fastqc_data.txt, quality_control/falco_after/HeLa-WT-input-rep1-run2_R1/summary.txt
    jobid: 30
    reason: Missing output files: quality_control/falco_after/HeLa-WT-input-rep1-run2_R1/fastqc_data.txt
    wildcards: rn=HeLa-WT-input-rep1-run2, rd=R1
    resources: tmpdir=/tmp

[Sat Oct  1 01:42:36 2022]
Error in rule map_to_contamination_by_bowtie2:
    jobid: 52
    output: bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.sam, bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.1.fq, bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.2.fq, bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.report
    shell:
        
        export LC_ALL="C"
        /opt/miniconda/bin/bowtie2 -p 24 --no-unal --end-to-end --fast --un-conc bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.fq -x /home/yec/projects/m6A_SACseq/m6A-SACseq/test/ref/contamination -1 cut_adapter/HeLa-WT-input-rep1-run2_cut_R1.fq.gz -2 cut_adapter/HeLa-WT-input-rep1-run2_cut_R2.fq.gz > bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.sam 2> >(tee bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.report >&2)
        
        (one of the commands exited with non-zero exit code; note that snakemake uses bash strict mode!)


[Sat Oct  1 01:42:36 2022]
rule falco_after:
    input: cut_adapter/HeLa-WT-treated-rep1-run1_cut_R1.fq.gz
    output: quality_control/falco_after/HeLa-WT-treated-rep1-run1_R1/fastqc_report.html, quality_control/falco_after/HeLa-WT-treated-rep1-run1_R1/fastqc_data.txt, quality_control/falco_after/HeLa-WT-treated-rep1-run1_R1/summary.txt
    jobid: 36
    reason: Missing output files: quality_control/falco_after/HeLa-WT-treated-rep1-run1_R1/fastqc_data.txt
    wildcards: rn=HeLa-WT-treated-rep1-run1, rd=R1
    resources: tmpdir=/tmp


[Sat Oct  1 01:42:36 2022]
rule falco_before:
    input: /home/yec/projects/m6A_SACseq/m6A-SACseq/test/rawdata/HeLa-WT-polyA-input-rep2-run2_R1.fq.gz
    output: quality_control/falco_before/HeLa-WT-input-rep2-run2_R1/fastqc_report.html, quality_control/falco_before/HeLa-WT-input-rep2-run2_R1/fastqc_data.txt, quality_control/falco_before/HeLa-WT-input-rep2-run2_R1/summary.txt
    jobid: 8
    reason: Missing output files: quality_control/falco_before/HeLa-WT-input-rep2-run2_R1/fastqc_data.txt
    wildcards: rn=HeLa-WT-input-rep2-run2, rd=R1
    resources: tmpdir=/tmp

Removing output files of failed job map_to_contamination_by_bowtie2 since they might be corrupted:
bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.sam, bowtie2_mapping/HeLa-WT-input-rep1-run1_contamination.report
Removing output files of failed job map_to_contamination_by_bowtie2 since they might be corrupted:
bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.sam, bowtie2_mapping/HeLa-WT-input-rep1-run2_contamination.report
[Sat Oct  1 01:42:37 2022]
Finished job 36.
1 of 260 steps (0.4%) done
[Sat Oct  1 01:42:37 2022]
Finished job 31.
2 of 260 steps (1%) done
[Sat Oct  1 01:42:37 2022]
Finished job 30.
3 of 260 steps (1%) done
[Sat Oct  1 01:42:37 2022]
Finished job 28.
4 of 260 steps (2%) done
[Sat Oct  1 01:42:37 2022]
Finished job 9.
5 of 260 steps (2%) done
[Sat Oct  1 01:42:37 2022]
Finished job 12.
6 of 260 steps (2%) done
[Sat Oct  1 01:42:37 2022]
Finished job 10.
7 of 260 steps (3%) done
[Sat Oct  1 01:42:37 2022]
Finished job 5.
8 of 260 steps (3%) done
[Sat Oct  1 01:42:37 2022]
Finished job 2.
9 of 260 steps (3%) done
[Sat Oct  1 01:42:37 2022]
Finished job 8.
10 of 260 steps (4%) done
[Sat Oct  1 01:42:37 2022]
Finished job 14.
11 of 260 steps (4%) done
[Sat Oct  1 01:42:37 2022]
Finished job 4.
12 of 260 steps (5%) done
Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: ../.snakemake/log/2022-10-01T014236.567420.snakemake.log
